var reform=function(t){"use strict";var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,i)};function i(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}var n=function(){return function(t){this.content=t.content}}();function o(t,e){for(var i in t)if("__proto__"!=i&&Object.prototype.hasOwnProperty.call(t,i)&&"function"!=typeof t[i]){var n=t[i];e[i]=n}}var r=function(t){function e(e){var i=t.call(this,e)||this;return i.isElement=!0,i.attributes=[],i.tag="",i.id="",i.class="",o(e,i),i}return i(e,t),e}(n),a=function(t){function e(e){var i=t.call(this,e)||this;return i.isInput=!0,o(e,i),i.convertToFinalValue=e.convertToFinalValue,i}return i(e,t),e}(n),s=function(t){function e(e){var i=t.call(this,e)||this;return i.isSection=!0,i.root=!1,o(e,i),i.convertToFinalValue=e.convertToFinalValue,i}return i(e,t),e}(n),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="root",e.root=!0,e}return i(e,t),e}(s),u=function(){function t(){this.regex=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,this.message="Please enter valid email address",this.name="email"}return t.prototype.method=function(t){return this.regex.test(t||"")},t}(),c=function(){function t(){this.name="notEmpty",this.message="Please don't leave this area empty "}return t.prototype.method=function(t){return null!=t&&""!=t.trim()},t}(),h=function(){function t(){this.name="notEmpty",this.message="Please don't leave this area empty "}return t.prototype.method=function(t){return!!t},t}(),f=function(){function t(t){this.minimumValue=t,this.name="min",this.message="Value is need to be greater or equal than "+t}return t.prototype.method=function(t){return parseFloat(t)>=this.minimumValue},t}(),p=function(){function t(t){this.maximumValue=t,this.name="min",this.message="",this.message="Value is need to be less or equal than "+t}return t.prototype.method=function(t){return parseFloat(t)<=this.maximumValue},t}(),d=function(){function t(t){this.minimumValue=t,this.name="min",this.message="Value is need to be greater than "+t}return t.prototype.method=function(t){return parseFloat(t)>this.minimumValue},t}(),v=function(){function t(t){this.maximumValue=t,this.name="min",this.message="",this.message="Value is need to be less than "+t}return t.prototype.method=function(t){return parseFloat(t)<this.maximumValue},t}(),m=function(){function t(){this.observers=[]}return t.prototype.notify=function(t){for(var e=0,i=this.observers;e<i.length;e++){i[e].update(this,t)}},t.prototype.subscribe=function(t){-1==this.observers.indexOf(t)&&this.observers.push(t)},t.prototype.unsubscribe=function(t){var e=this.observers.indexOf(t);e>-1&&this.observers.splice(e,1)},t}(),y=function(){return function(){}}(),b=function(t){function e(e){var i=t.call(this)||this;return i.updateEvent=e,i}return i(e,t),e.prototype.update=function(t,e){this.updateEvent(e)},e}(y);function g(t,e,i){var n,o,r=document.createElement(i.tag||"div");i.class&&(r.className=i.class),i.id&&(r.id=i.id);var a=null===(n=i.attributes)||void 0===n?void 0:n.filter(function(t){return null!=t});if((null==a?void 0:a.length)>0)for(var s=0;s<a.length;s++){var l=a[s];("class"!=l.key&&"style"!=l.key||l.value)&&r.setAttribute(l.key,l.value||"")}for(var u in i.eventBindings||{})if(Object.prototype.hasOwnProperty.call(i.eventBindings,u))for(var c=null===(o=i.eventBindings[u])||void 0===o?void 0:o.filter(function(t){return null!=t}),h=function(i){var n=null==c?void 0:c[i];r.addEventListener(u,function(i){n(t,i,e)})},f=0;f<(null==c?void 0:c.length);f++)h(f);return r}var F=function(){function t(t,e,i,n){this.initialField=t,this.reflector=e,this.baseParentalElement=i,this.parentSectionReflection=n,this.constructReflection()}return t.prototype.constructReflection=function(){this.initialField=this.initialField;var t=g(this,this.reflector,this.initialField);this.baseParentalElement.appendChild(t),"string"==typeof this.initialField.content?t.textContent=this.initialField.content:this.subReflections=this.reflector.expand(t,this.initialField,this.parentSectionReflection),this.element=t},t.prototype.getElementByName=function(t){var e;return null===(e=this.subReflections)||void 0===e?void 0:e.find(function(e){return e.name===t})},t.prototype.setErrorMessageVisibility=function(t){for(var e=0;e<this.subReflections.length;e++){this.subReflections[e].setErrorMessageVisibility(t)}},t}(),V=function(){function t(t,e,i,n){this.initialField=t,this.reflector=e,this.baseParentalElement=i,this.parentSectionReflection=n,this.value="",this.validationErrors={},this.value=t.initialValue,this.initialField=t,this.constructReflection()}return t.prototype.constructReflection=function(){var t=this,e=this.initialField;this._baseElement&&(this._baseElement.innerHTML="",this._baseElement.innerText="");var i,n,o=e.template||"\n            <div>$label</div>\n            <div>$input</div>\n            <div>$message</div>";"checkbox"===e.inputType?(i='<input reformjs-input type="checkbox"> <span reformjs-input-label>'+(e.label||e.name)+"</span>",n="<span></span>"):(i='<input reformjs-input type="'+e.inputType+'">',n="<span reformjs-input-label>"+(e.label||e.name)+"</span>");var r=o.replace("$label",n).replace("$input",i).replace("$message","<span reformjs-message></span>"),a=document.createElement("div");a.innerHTML=r;var s=a.querySelector("[reformjs-input]"),l=a.querySelector("[reformjs-message]");this._inputElement=s,this._messageElement=l,this.initialField.placeholder&&(s.placeholder=this.initialField.placeholder),this.initialField.initialValue&&(s.value=this.initialField.initialValue),s.addEventListener("input",function(i){var n,o=i.target;n="checkbox"===e.inputType?o.checked:"number"===e.inputType?o.valueAsNumber:o.value,t.changeValue(n)}),this.baseParentalElement.appendChild(a)},t.prototype.changeValue=function(t){this.rawValue=t,this.rawToFinalValue?this.value=this.rawToFinalValue(t):this.value=t,this.parentSectionReflection.valueChanged(),this.validate()},t.prototype.validate=function(){var t;this.validationErrors={};for(var e=0;e<(null===(t=this.initialField.validations)||void 0===t?void 0:t.length);e++){var i=this.initialField.validations[e];i&&(i.method(this.value)||(this.validationErrors[i.name]={invalid:!0,message:i.message}))}this.setValidationText()},t.prototype.setValidationText=function(){var t=this._messageElement,e=Object.keys(this.validationErrors);e.length>0&&this.showErrorMessage?(t.style.display="block",t.textContent=this.validationErrors[e[0]].message):(t.style.display="none",t.textContent="")},t.prototype.setValueExternal=function(t,e){void 0===e&&(e=!0);var i=this._inputElement,n=this.initialField.inputType;"checkbox"===n?i.checked=t:"number"===n&&parseInt(t)?i.valueAsNumber=parseInt(t):i.value=t,e&&this.changeValue(t)},t.prototype.setErrorMessageVisibility=function(t){this.validate(),this.showErrorMessage=t,this.setValidationText()},t}(),E=function(){function t(t,e,i,n){this.initialField=t,this.reflector=e,this.baseParentalElement=i,this.parentSectionReflection=n,this.subReflections=[],this.constructReflection()}return t.prototype.constructReflection=function(){var t=this.initialField,e=this.reflector;this.onValueChange=new m,this.initialField=t,e.expand(this.baseParentalElement,t,this)},t.prototype.valueChanged=function(){this.rawValue=this.collectSectionData(),this.parentSectionReflection?this.parentSectionReflection.valueChanged():this.onValueChange.notify()},t.prototype.getValue=function(t){return this.collectSectionData(t)},t.prototype.dataCollection=function(t,e){for(var i=this.subReflections.filter(function(t){return t.initialField.isInput||t.initialField.isSection}),n=0;n<i.length;n++){var o=i[n];if(o.initialField.isInput){var r=o;r.value&&e(r.value,r.initialField.name)}else if(o.initialField.isSection){var a=o,s=a.collectSectionData(t);s&&("object"!=typeof s||Object.keys(s).length>0)&&e(s,a.initialField.name)}}},t.prototype.convertDataByMode=function(t,e){return"final"===e&&this.initialField.convertToFinalValue?this.initialField.convertToFinalValue(t):t},t.prototype.collectSectionData=function(t){if(void 0===t&&(t="final"),this.initialField.arraySectionRaw){var e=[];return this.dataCollection(t,function(t){e.push(t)}),this.convertDataByMode(e,t)}var i={};return this.dataCollection(t,function(t,e){i[e]=t}),this.convertDataByMode(i,t)},t.prototype.collectValidationErrors=function(){for(var t=this.initialField.name?this.initialField.name+".":"",e={},i=0;i<this.subReflections.length;i++){var n=this.subReflections[i];if(n.initialField.isInput){var o=n;o.validate(),e[t+n.initialField.name]=o.validationErrors}else if(n.initialField.isSection){var r=n.collectValidationErrors();for(var a in r)if(Object.prototype.hasOwnProperty.call(r,a)){var s=r[a];null!=s&&Object.keys(s).length>0&&(e[t+a]=s)}}}return e},t.prototype.setValue=function(t){if(t instanceof Object){var e=t;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var n=e[i];if("function"!=typeof n&&"__proto__"!=i){var o=this.findSubReflectionByName(i);o.initialField.isSection?o.setValue(n):o.initialField.isInput&&o.setValueExternal(n)}}}},t.prototype.findSubReflectionByName=function(t){var e;return null===(e=this.subReflections)||void 0===e?void 0:e.find(function(e){return e.initialField.name===t})},t.prototype.setErrorMessageVisibility=function(t){for(var e=0;e<this.subReflections.length;e++){this.subReflections[e].setErrorMessageVisibility(t)}},t}(),R=function(){function t(t){this.rootManifest=t,this.idMap={},this.onValueChange=new m}return t.prototype.expandThere=function(t){var e=this;if(this.baseElement=null,this.baseElement="string"==typeof t?document.querySelector(t):t,!this.baseElement)throw"No provided element. Please make sure element is not null";this.rootSectionReflection=new E(this.rootManifest,this,this.baseElement,null),this.rootSectionReflection.onValueChange.subscribe(new b(function(t){e.onValueChange.notify(t)}))},t.prototype.expand=function(t,e,i){var n,o=e.content,r=[];if(o instanceof Array){for(var a=0;a<o.length;a++){var s=o[a],l=void 0;if(s.isSection&&(l=new E(s,this,t,i)),s.isElement)l=new F(s,this,t,i);s.isInput&&(l=new V(s,this,t,i)),i&&l&&!s.isElement&&(i.subReflections.push(l),r.push(l)),(null===(n=null==l?void 0:l.initialField)||void 0===n?void 0:n.id)&&(this.idMap[l.initialField.id]=l)}return r}},t.prototype.findReflectionById=function(t){return this.idMap[t]},t.prototype.getValue=function(t){return void 0===t&&(t=!0),this.rootSectionReflection.getValue(t?"final":"raw")},t.prototype.patchValue=function(t,e){this.rootSectionReflection.setValue(t)},t.prototype.collectValidationErrors=function(){return this.rootSectionReflection.collectValidationErrors()},t.prototype.setErrorMessageVisibility=function(t){this.rootSectionReflection.setErrorMessageVisibility(t)},t}(),S=function(){return function(){}}(),_=Object.freeze({__proto__:null,ElementField:r,InputField:a,InitialFied:n,RootSectionField:l,SectionField:s,EmailValidator:u,NotEmpty:c,NeedToBeTrue:h,MinimumNumber:f,MaximumNumber:p,NumberGreaterThan:d,NumberLessThan:v,Reflector:R,Reflection:S,InputReflection:V,SectionReflection:E,ElementReflection:F,ObjectFieldTransfer:o,createElement:g,Observer:y,Subject:m,EventObserve:b});window.Reform=_;var x=_;return t.a=x,t}({});